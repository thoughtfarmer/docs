# ThoughtFarmer security measures

ThoughtFarmer has been security hardened against a wide variety of common web application vulnerabilities. This has allowed us to pass security audits performed by expert consultants on behalf of our clients. The following is a description of the ways ThoughtFarmer is hardened against the top 10 web application vulnerabilities as defined by the Open Web Application Security Project [https://www.owasp.org/index.php/Top\_10\_2007](https://www.owasp.org/index.php/Top_10_2007).  
  
[A1 - Cross Site Scripting \(XSS\)](http://www.owasp.org/index.php/Top_10_2007-A1) XSS flaws occur whenever an application takes user supplied data and sends it to a web browser without first validating or encoding that content. XSS allows attackers to execute script in the victim's browser which can hijack user sessions, deface web sites, possibly introduce worms, etc.By default the ASP.NET framework will protect against data submitted with XSS attacks in it by detecting un-encoded HTML and throwing an error. On pages that have an embedded rich text editor \(e.g. editing a page\), this feature is disabled \(to allow the ability to submit HTML\) and content from the rich text editor control is filtered by the ckEditor component. Note that disabling the script filter is possible in the configuration options, and could open up your intranet to XSS attacks. We do not recommend enabling script embedding in the rich text editor if you require enhanced security. Any scripts added do need to be added by authenticated users. So malicious scripts can always be tracked.  
  
[A2 - Injection Flaws](http://www.owasp.org/index.php/Top_10_2007-A2) Injection flaws, particularly SQL injection, are common in web applications. Injection occurs when user-supplied data is sent to an interpreter as part of a command or query. The attacker's hostile data tricks the interpreter into executing unintended commands or changing data.  
ThoughtFarmer uses stored procedures for data access and does not build SQL statements through string concatenation \(i.e. dynamic sql\). Any interface element that does end up being used as parameters to SQL statements are all filtered and escaped to prevent any malicious code execution from getting through to the database. This MSDN article describes how we are using stored procedures: [http://msdn.microsoft.com/en-us/library/ms998271.aspx\#paght000002\_step2](http://msdn.microsoft.com/en-us/library/ms998271.aspx#paght000002_step2)  
  
[A3 - Malicious File Execution](http://www.owasp.org/index.php/Top_10_2007-A3) Code vulnerable to remote file inclusion \(RFI\) allows attackers to include hostile code and data, resulting in devastating attacks, such as total server compromise. Malicious file execution attacks affect PHP, XML and any framework which accepts filenames or files from users.  
ThoughtFarmer accepts file uploads with a restricted whitelist of file extensions. The files themselves are stored only in the database as blobs are not written to the filesystem so they cannot be executed.  
[A4 - Insecure Direct Object Reference](http://www.owasp.org/index.php/Top_10_2007-A4) A direct object reference occurs when a developer exposes a reference to an internal implementation object, such as a file, directory, database record, or key, as a URL or form parameter. Attackers can manipulate those references to access other objects without authorization.  
ThoughtFarmer secures every URL accessed by a user. If a user can access the url [http://intranet/content/1234](http://intranet/content/1234), simply changing the url to another number like 1235 does not allow them to access that page.  
[A5 - Cross Site Request Forgery \(CSRF\)](http://www.owasp.org/index.php/Top_10_2007-A5) A CSRF attack forces a logged-on victim's browser to send a pre-authenticated request to a vulnerable web application, which then forces the victim's browser to perform a hostile action to the benefit of the attacker. CSRF can be as powerful as the web application that it attacks.   
ThoughtFarmer uses ASP.NET MVC with Antiforgery token validation. This means that each request places a secure token on the client's page. This way any posts made from that page must be specifically made from that client's browser and not a cross-site forgery. This makes it impossible for a hacker to perform this type of attack. For more information see http://blog.stevensanderson.com/2008/09/01/prevent-cross-site-request-forgery-csrf-using-aspnet-mvcs-antiforgerytoken-helper/.  
  
[A6 - Information Leakage and Improper Error Handling](http://www.owasp.org/index.php/Top_10_2007-A6) Applications can unintentionally leak information about their configuration, internal workings, or violate privacy through a variety of application problems. Attackers use this weakness to steal sensitive data, or conduct more serious attacks.  
ThoughtFarmer displays friendly error messages to users when something bad occurs, with the real error message being logged behind the scenes.  
[A7 - Broken Authentication and Session Management](http://www.owasp.org/index.php/Top_10_2007-A7) Account credentials and session tokens are often not properly protected. Attackers compromise passwords, keys, or authentication tokens to assume other users' identities.  
ThoughtFarmer has a Forms Authentication session cookie that we store once the user has authenticated. Once that unique session cookie exists, then we do not re-authenticate the user. Once the user closes his browser or the session times out, the user will be forced to re-authenticate.  
[A8 - Insecure Cryptographic Storage](http://www.owasp.org/index.php/Top_10_2007-A8) Web applications rarely use cryptographic functions properly to protect data and credentials. Attackers use weakly protected data to conduct identity theft and other crimes, such as credit card fraud.  
ThoughtFarmer does not store password information for users for windows authentication. Authentication in this case is the responsibility of IIS. For service accounts, external users, or Cloud users not synced with AD, where passwords are required to be stored, ThoughtFarmer encrypts the password using the built in .NET encryption libraries via the Rijndael symmetric encryption algorithm before storing in the database.  
[A9 - Insecure Communications](http://www.owasp.org/index.php/Top_10_2007-A9) Applications frequently fail to encrypt network traffic when it is necessary to protect sensitive communications.ThoughtFarmer has network traffic between itself and SQL Server, a mail server and possibly with external RSS feeds. The communications between SQL Server and the mail server are internal, and not over an open network. Communicating with external RSS feeds are merely a request for public information.  
  
When accessing ThoughtFarmer over an untrusted network \(i.e. the Internet\) it should be configured to run over SSL.  
  
[A10 - Failure to Restrict URL Access](http://www.owasp.org/index.php/Top_10_2007-A10) Frequently, an application only protects sensitive functionality by preventing the display of links or URLs to unauthorized users. Attackers can use this weakness to access and perform unauthorized operations by accessing those URLs directly.  
.  
Each request to ThoughtFarmer is checked for security based on the user that has logged in. No url can be accessed without that security check running first.  


